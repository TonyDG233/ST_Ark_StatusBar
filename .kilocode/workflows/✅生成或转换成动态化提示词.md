task: reappear a dynamic prompt using embedded javascript based on Explorer's request inside `<context>` using variables in <variable_schema> block, which is the main content of your reply
interface:
  - |-
    /**
     * get variable value
     *
     * @param path variable path
     * @param options optional options
     *   - `defaults:any`: the default value to return if the variable is not defined
     * @returns variable value
     *
     * @example
     * // get variable, if not defined, returns `undefined`
     * getvar('stat_data.白川璃.好感度');
     *
     * @example
     * // check if a variable exists
     * if (getvar('stat_data.白川璃.好感度') !== undefined)
     *
     * @example
     * // get variable, if not defined, returns `defaults`
     * getvar('stat_data.白川璃.好感度', { defaults: 0 });
     */
    function getvar(path: string, options: { defaults?: any } = { defaults: undefined }): any
  - |-
    /**
     * check if any pattern is matched in chat messages
     *
     * @param pattern the pattern to match
     * @param options optional options
     *   - `start:number`: the inclusive start index of the message to match; defaults to -2, i.e. the last two messages
     *   - `end:number`: the exclusive end index of the message to match; defaults to 0
     *   - `role:'system' | 'assistant' | 'user'`: the role of the message to check; defaults to check all roles
     * @returns true if any pattern is matched, false otherwise
     *
     * @example
     * // check if '你好' or '再见' appears in the last two messages
     * matchChatMessages(['你好', '再见']);
     */
    function matchChatMessages(
      pattern: string | RegExp | (string | RegExp)[],
      options: { start?: number; end?: number; role?: 'system' | 'assistant' | 'user' } = {
        start: -2,
        end: 0,
        role: undefined,
      },
    ): boolean;
rule:
  - use `<%_ ${code} _%>` to embed a javascript logic inside prompt
  - use `<%= ${code} _%>` or `<%_ print(${code}) _%>` to output a javascript expression into prompt
  - lodash and faker are available
  - all embedded javascript will be gathered together and executed in order, so be careful of redefining scope variables; prefer to invoke `getvar` inplace instead of defining a scope variable assigned `getvar` result
  - when accessing variables in <variable_schema>, always prefix the variable with `stat_data.`, such as `getvar('stat_data.白川璃.好感度')`
example: |-
  <%_ if (getvar('stat_data.角色.${主名}.背包', { defaults: [] }).includes('${item name}')) { _%>
  你背包里有${item name}，可以用来做什么。
  <%_ } else { _%>
  你背包里没有${item name}，不能用来做什么。
  <%_ } _%>
format:
  <variable_schema> block not exists: |-
    disclaimer: 我不能生成动态化提示词，因为你还没有为我提供变量列表, 请将它包含在`<variable_schema>`...`</variable_schema>`中发送给我
  <variable_schema> block exists: |-
    <context>
    ```
    ...
    ```
    </context>